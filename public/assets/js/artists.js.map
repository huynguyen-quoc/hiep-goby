{"version":3,"sources":["artists.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"artists.js","sourcesContent":["/**\n * Created by huynguyen on 8/20/16.\n */\n(function($){\n\n\n   var ArtistPage = function(){\n\n        var initPage = function(){\n            $('body').toggleClass('artists');\n            $('.loader-container').toggleClass(\"active\");\n            $('.grid-masonry').toggleClass(\"active\");\n\n            initGrid();\n        };\n\n        var initGrid = function(){\n            var $grid = $('.grid-masonry').masonry({\n                columnWidth: '.grid-column-size',\n                itemSelector: '.masonry-brick',\n                percentPosition: true\n            });\n\n            var infiniteScroll = $('.grid-masonry').infinitescroll({\n                    navSelector  : \"#pagination\",\n                    // selector for the paged navigation (it will be hidden)\n                    nextSelector : \"#pagination p a\",\n                    // selector for the NEXT link (to page 2)\n                    itemSelector : \".grid-masonry .masonry-brick\",\n                    dataType : 'json',\n                    debug: true,\n                    loading: {\n                        finished:  function(){\n                            $('#loading-more-btn').html(' <span class=\"gobyArtIcon medium\">F</span><br>Load More</a>');\n                        },\n                        finishedMsg: '',\n                        img: undefined,\n                        msg: undefined,\n                        msgText :'',\n                        selector: null,\n                        speed: 'fast',\n\n                        start:  function(opts){\n                            $('#loading-more-btn').html(' <span class=\"gobyArtIcon medium\">F</span><br>Loading...</a>');\n                            var  path = opts.path;\n                            opts.state.currPage++;\n                            var  desturl = (typeof path === 'function') ? path(opts.state.currPage) : path.join(opts.state.currPage);\n\n                            $.ajax({\n                                dataType: 'json',\n                                type: 'GET',\n                                url: desturl,\n                                success: function (data, textStatus, jqXHR) {\n                                    opts.loading.finished.call($(opts.contentSelector)[0],opts);\n                                    opts.state.isDuringAjax = false;\n                                    opts.callback($(opts.contentSelector)[0],data,desturl);\n                                },\n                                error: function() {\n                                }\n                            });\n                        }\n                    },\n                    appendCallback: false,\n                    path : function(currentPageNumber){\n                        return (window.location.href+'?page=' + currentPageNumber);\n                    }\n                },\n                // Function called once the elements are retrieved\n                function(data) {\n                    var artists =  data.artists;\n                    var temps = [];\n                    $.each(artists, function(index, artist){\n                        var url = '/assets/upload/' + artist.artist_type_slug + '/' + artist.artist_slug + '/' + artist.artist_avatar;\n                        var template = \"<div class='masonry-brick'> <article class='model grid-item' data-artist=''>\" +\n                            \"<a href='/nghe-si' > \" +\n                            \"<div class='model-img-wrapper model-background-img-wrapper' style='background-image: url(\" + url + \")'>\" +\n                            \"<div class='model-name-box'> <span class='model-name' data-name='\" + artist.artist_name + \"'></span> </div>\" +\n                            \"<div class='wishlist-icon-wrapper in-wishlist' > <div class=''>\" +\n                            \"<span class='model-is-active gobyArtIcon'>D</span> <span class='gobyArtIcon'>S</span> </div> </div>\" +\n                            \"<div class='wishlist-toggle-wrapper'> <div class='in-wishlist'> \" +\n                            \"<span class='icon-label s_hidden'>Shortlist remove</span> \" +\n                            \"<span class='icon-label l_hidden m_hidden'>Shortlist </span> \" +\n                            \"<span class='sofaIcon l_hidden m_hidden'>D</span> \" +\n                            \"</div>\" +\n                            \"<div class='not-in-wishlist'>\" +\n                            \"<span class='icon-label s_hidden'>Add to shortlist</span>\" +\n                            \" <span class='icon-label l_hidden m_hidden'>Shortlist +</span>\" +\n                            \"</div>\" +\n                            \"</div>\" +\n                            \"</div> </a> \" +\n                            \"<div class='model-name-wrapper'> <a href='#'> <span class='model-name'>\" + artist.artist_name + \"</span> </a>\"+\n                            \"</div> </article> </div>\";\n                        // $grid.append($.parseHTML(template));\n                        temps.push($.parseHTML(template)[0]);\n                    });\n                    temps = $(temps).css('opacity', 0);\n                    temps.animate({opacity: 1});\n                    $grid.append(temps);\n                    $grid.masonry('appended', temps);\n            });\n\n            $(\".grid-item\").mouseenter(function(e){\n                var $this = $(this);\n                var artist = $this.data('artist');\n                if(artist) {\n                    var words = CryptoJS.enc.Base64.parse(artist);\n                    var textString = CryptoJS.enc.Utf8.stringify(words);\n                    initImagePopover(e, JSON.parse(textString))\n                }\n            });\n\n            $(\".grid-item\").hoverIntent({\n                over: showPopover,\n                out: hidePopover\n            });\n        }\n\n        var showPopover=function(event){\n           window.clearTimeout(window.showPopoverTimeout);\n\n           var targetEl=$(event.currentTarget);\n           if(targetEl==undefined) return false;\n           var targetElPosition=targetEl.offset();\n\n           var top=targetElPosition.top;\n           var left=targetElPosition.left;\n           var height=targetEl.outerHeight();\n           var width=targetEl.outerWidth();\n           var padding=targetEl.parent().innerHeight()-height;\n\n           var popupMainCss={\n               top: top - padding,\n               left: left - padding,\n           };\n           var popupInfoCss={\n               top: 0,\n               left: 0,\n               width: width + 2 * padding,\n               padding: padding\n           };\n           var modelInfoCss={\n               marginTop: height + padding\n           };\n           var popupGridCss={\n               top: 0,\n               left: 'auto',\n               right: 'auto',\n               width:  popupInfoCss.width * 1.05,\n               paddingTop: padding,\n               paddingRight: 0,\n               paddingBottom: 0,\n               paddingLeft: 0,\n               display: 'block'\n           };\n           var popupGridColumnCss={\n               paddingRight: 0,\n               paddingLeft: 0,\n               marginBottom: padding\n           };\n\n           var offsetParent=$('body');\n           var offsetParentWidth=offsetParent.innerWidth();\n\n           var shadowCss={};\n           if(left < (offsetParent.offset().left+offsetParentWidth/2)){\n               // position on right\n               popupGridCss.left=popupInfoCss.width;\n               popupGridColumnCss.paddingRight=padding;\n               $('#model-image-popover').removeClass(\"model-on-right\").addClass(\"model-on-left\").css(shadowCss);\n           }\n           else{\n               // position on left\n               popupGridCss.left=-popupGridCss.width;\n               popupGridColumnCss.paddingLeft=padding;\n               $('#model-image-popover').removeClass(\"model-on-left\").addClass(\"model-on-right\").css(shadowCss);\n\n           }\n\n           // apply css\n           $('#model-image-popover').css(popupMainCss);\n           $('#model-image-popover-info').css(popupInfoCss);\n           $('#model-image-popover-info #model-info').css(modelInfoCss);\n           $('#model-image-popover-grid').css(popupGridCss);\n           $('#model-image-popover-grid .grid-model-image-popover-column').css(popupGridColumnCss);\n\n           // change layer ordering\n           targetEl.closest('.grid-masonry').find(\".model\").css({'z-index':0});\n           targetEl.css({'z-index':29});\n\n           window.showPopoverTimeout=window.setTimeout(function(){$('#model-image-popover').hide().fadeIn(100);}, 250);\n       };\n\n        var hidePopover = function(event){\n           window.clearTimeout(window.showPopoverTimeout);\n           $('#model-image-popover').fadeOut(100);\n        };\n\n        var initImagePopover=function(event, model){\n           var information_data_1 = model.artist_extra_1;\n           var information_data_2 = model.artist_extra_2;\n           $('#model-image-popover .model-info-model-name').html(model['artist_full_name']);\n           $('#model-image-popover .model-type').html(\"(\" + model['artist_type_name'] + \")\");\n           var information1Data = '';\n           var information2Data = '';\n           $('#model-image-popover .model-info-col-1').empty();\n           $('#model-image-popover .model-info-col-2').empty();\n\n           $.each(information_data_1 , function(){\n               var template = '<div class=\"model-info-detail\">' +\n                   '<span class=\"model-detail-label\">' + this.title + '</span>' +\n                   '<span class=\"model-detail-value\" >' + this.value + '</span>' +\n                   '</div>';\n               information1Data += template;\n           });\n           $.each(information_data_2 , function(){\n               var template = '<div class=\"model-info-detail\">' +\n                   '<span class=\"model-detail-label\">' + this.title + '</span>' +\n                   '<span class=\"model-detail-value\" >' + this.value + '</span>' +\n                   '</div>';\n               information2Data += template;\n           });\n           $('#model-image-popover .model-info-col-1').html(information1Data);\n           $('#model-image-popover .model-info-col-2').html(information2Data);\n\n           $.ajax({\n               url : '/api/image/preview/' + model.artist_slug,\n               type:\"GET\",\n               contentType:\"application/json; charset=utf-8\",\n               dataType:\"json\",\n               success: function(data){\n                   $('#model-image-popover-grid .grid-model-image-popover .grid-model-image-popover-column').empty();\n                   if(data.length > 0){\n                       var template  =  '<div class=\"grid-item\"> <img src=\"/assets/upload/' + data[0].artist_type + '/' + data[0].artist_name + '/' + data[0].file_name + '\"></div>';\n                       if(data.length > 1) {\n                           template += '<div class=\"grid-item\"> <img src=\"/assets/upload/' +  data[1].artist_type+ '/' + data[1].artist_name + '/' +  data[1].file_name + '\"></div>';\n                       }\n                       $('#model-image-popover-grid .grid-model-image-popover .grid-model-image-popover-column.column-1').html(template);\n                       template  = '';\n                       if(data.length > 2) {\n                           template +=' <div class=\"grid-item\"> <img src=\"/assets/upload/' + data[2].artist_type + '/' + data[2].artist_name + '/' + data[2].file_name + '\"></div>';\n                           if(data.length > 3) {\n                               template += '<div class=\"grid-item\"> <img src=\"/assets/upload/' +  data[3].artist_type+ '/' + data[3].artist_name + '/' +  data[3].file_name + '\"></div>';\n                           }\n                       }\n                       $('#model-image-popover-grid .grid-model-image-popover .grid-model-image-popover-column.column-2').html(template);\n                   }\n               }\n           });\n\n           //   var requestId = model['artist_slug'] + \"_\" + Math.random();\n//            if(requestId!=$scope.imagePopover.requestId){\n//                $scope.imagePopover.images=$scope.defaultImagePopoverImageArray;\n//            }\n//            $scope.imagePopover.requestId=requestId;\n//            $scope.imagePopover.isActive=true;\n//            $scope.imagePopover.model=model;\n//\n//            ImageSet.server().get({imageTypeString:'preview',modelString:model.name},function(data){\n//                if(data.$resolved && (!data.data!=undefined) && (requestId==$scope.imagePopover.requestId)){\n//                    $scope.imagePopover.images=ImageSet.getImagesFromImageSet(data);\n//                }\n//            });\n       };\n\n        return {\n            initImagePopover : initImagePopover,\n            showPopover : showPopover,\n            hidePopover : hidePopover,\n            initPage : initPage\n        }\n   };\n\n   return ArtistPage;\n})(window.jQuery);"],"sourceRoot":"/source/"}